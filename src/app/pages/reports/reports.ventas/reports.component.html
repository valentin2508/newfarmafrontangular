<div class="container-fluid">
  <div class="card">
    <div class="card-header">
      <h3 class="card-title fw-bold">Reporte de Ventas</h3>
      <div class="card-tools d-flex align-items-center" style="position: relative;">
  <!-- Inputs absolutamente centrados -->
  <div class="d-flex gap-2" style="position: relative; left: 50%; transform: translateX(-70%);">
    <label class="">Serie:</label>
    <input type="search" placeholder="Buscar..." class="form-control form-control-sm" style="width: 150px;" [(ngModel)]="filterSerie" (input)="applyFilters()">
     <label class="">Correlativo:</label>
     <input type="search" placeholder="Buscar..." class="form-control form-control-sm" style="width: 150px;" [(ngModel)]="filterCorrelativo" (input)="applyFilters()">
     <label class="">Search:</label>
     <input type="search" placeholder="Buscar..." class="form-control form-control-sm" style="width: 150px;" [(ngModel)]="filterSearch" (input)="applyFilters()">
  </div>
  
  <!-- BotÃ³n a la derecha -->
  <button class="btn btn-success btn-sm ms-auto">
    <i class="fas fa-file-excel"></i> Exportar
  </button>
</div>
    <div class="card-body">
      <table class="table table-bordered table-striped border-black">
         <thead>
           <tr>
             <th (dblclick)="toggleFilter('id')">
               ID Venta
               <i class="fas fa-search ml-4"></i>
               <input *ngIf="showFilterId" [(ngModel)]="filterId" (input)="applyFilters()" placeholder="Buscar ID..." class="form-control form-control-sm mt-1">
             </th>
             <th >
               Serie
               
               <input *ngIf="showFilterSerie" [(ngModel)]="filterSerie" (input)="applyFilters()" placeholder="Buscar Serie..." class="form-control form-control-sm mt-1">
             </th>
             <th >
               Correlativo
               
               <input *ngIf="showFilterCorrelativo" [(ngModel)]="filterCorrelativo" (input)="applyFilters()" placeholder="Buscar Correlativo..." class="form-control form-control-sm mt-1">
             </th>
             <th (dblclick)="toggleFilter('fecha')">
               Fecha
               <i class="fas fa-search ml-4"></i>
               <input *ngIf="showFilterFecha" [(ngModel)]="filterFecha" (input)="applyFilters()" placeholder="Buscar Fecha..." class="form-control form-control-sm mt-1">
             </th>
             <th (dblclick)="toggleFilter('total')">
               Total
               <i class="fas fa-search ml-4"></i>
               <input *ngIf="showFilterTotal" [(ngModel)]="filterTotal" (input)="applyFilters()" placeholder="Buscar Total..." class="form-control form-control-sm mt-1">
             </th>
             <th (dblclick)="toggleFilter('cliente')">
               Cliente
               <i class="fas fa-search ml-4"></i>
               <input *ngIf="showFilterCliente" [(ngModel)]="filterCliente" (input)="applyFilters()" placeholder="Buscar Cliente..." class="form-control form-control-sm mt-1">
             </th>
             <th>Acciones</th>
           </tr>
         </thead>
        <tbody>
           <ng-container *ngFor="let venta of filteredVentas">
            <tr (click)="toggleDetalles(venta.idventa!)" style="cursor: pointer;">
              <td>{{ venta.idventa }}</td>
              <td>{{ venta.serie }}</td>
              <td>{{ venta.correlativo }}</td>
              <td>{{ venta.fechaventa | date: 'dd/MM/yyyy' }}</td>
              <td>S/ {{ venta.costoventa?.toFixed(2) }}</td>
              <td>{{ venta.cliente.persona.nombre }} {{ venta.cliente.persona.paterno }}</td>
              <td>
                <button class="btn btn-primary btn-sm" (click)="reimprimirTicket(venta); $event.stopPropagation();">
                  Reimprimir
                </button>
              </td>
            </tr>
            <tr class="tbodys" *ngIf="selectedVentaId === venta.idventa">
              <td  colspan="7">
                <div  *ngIf="detallesVenta[venta.idventa!]">
                  <h5>Detalles de la Venta</h5>
                  <table class="table table-sm table-striped">
                    <thead>
                      <tr>
                        <th>Producto</th>
                        <th>Cantidad</th>
                        <th>Precio Unitario</th>
                        <th>Subtotal</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let detalle of detallesVenta[venta.idventa!]">
                        <td>{{ detalle.producto.nombre }}</td>
                        <td>{{ detalle.unidades }}</td>
                        <td>S/ {{ detalle.costounidad.toFixed(2) }}</td>
                        <td>S/ {{ detalle.total.toFixed(2) }}</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </td>
            </tr>
          </ng-container>
        </tbody>
      </table>
    </div>
    <div class="card-footer">
      <div class="paginador">
        <button (click)="previoPage()" class="btn btn-primary btn-sm">&lt;</button>
        <app-paginate [total]="totalVentas" [npage]="pages" (SendIndex)="onPageChange($event)"></app-paginate>
        <button (click)="nextPage()" class="btn btn-primary btn-sm">&gt;</button>
      </div>
    </div>
  </div>
</div>
